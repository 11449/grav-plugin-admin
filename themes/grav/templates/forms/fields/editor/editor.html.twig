{% set value = (value is null ? field.default : value) %}
{% if not codemirrorOptions %}
    {% set codemirrorOptions = {'mode': 'gfm', 'ignore': ['code', 'preview']}|merge(field.codemirror|default({})) %}
{% endif %}

{% block label %}
    {{ dump(codemirrorOptions) }}
    {% if field.label %}
        {% set hint = field.help ? 'data-hint="' ~ field.help ~ '"': '' %}
        <div class="form-label form-field hint--bottom" {{ hint }}>{{ field.label|t }}</div>
    {% endif %}
{% endblock %}
{% block field %}
    <div class="form-field">
        <div class="form-data grav-editor">
            <div class="grav-editor-content">
                <textarea
                    data-grav-editor="{{ {'codemirror': codemirrorOptions} | json_encode|e('html_attr') }}"
                    data-grav-editor-mode="editor"
                    name="{{ (scope ~ field.name)|fieldName }}"
                    {% if field.disabled or isDisabledToggleable %}disabled="disabled"{% endif %}
                    {% if 'preview' not in codemirrorOptions.ignore %}data-grav-urlpreview="{{ base_url }}/media/{{ admin.route|trim('/') }}.json"{% endif %}
                >{{ value|join("\n")|e('html') }}</textarea>
            </div>
        </div>
    </div>
{% endblock %}
